<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.edu.module.dao.EnrollUserDao">


    <select id="selectEnrollUserByPage" resultType="net.edu.module.vo.EnrollUserVO">
        select id,wx_name,name,phone,union_id,open_id,area,address,age,grade,purpose,status,create_time,
        update_time,login_time,start_number,end_number,remark,integral,balance,deleted,creator,updater,version
        from enroll_user
        where deleted = 0
        <if test="query.getName() !=null and query.getName()!=''">
            and name like concat('%',#{query.name},'%')
        </if>
        <if test="query.getGrade() !=null and query.getGrade()!=''">
            and grade = #{query.grade}
        </if>
        <if test="query.getStatus() !=null ">
            <if test="query.getStatus() == 2">
                and status = 2 or status = 3
            </if>
            <if test="query.getStatus() == 1">
                and status = 1
            </if>
            <if test="query.getStatus() == 4">
                and status = 4
            </if>
        </if>
        <if test="query.getArea() !=null and query.getArea()!=''">
            and area =#{query.area}
        </if>
        <if test="query.getPurpose() !=null and query.getPurpose()!=''">
            and purpose like concat('%',#{query.purpose},'%')
        </if>
        <if test="query.getBeginTime() !=null and query.getBeginTime()!='' and query.getEndTime() !=null and query.getEndTime()!=''">
            and create_time &gt;=#{query.beginTime}  and create_time &lt;=#{query.endTime}
        </if>
        order by status,update_time desc
    </select>

    <update id="updateConfirmEnrollUser">
        update enroll_user set status=status+1
        where id=#{id}
    </update>
</mapper>
