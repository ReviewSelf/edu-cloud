<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="net.edu.module.dao.TeachClassDao">

    <resultMap type="net.edu.module.entity.TeachClassEntity" id="teachClassMap">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="description" column="description"/>
        <result property="img" column="img"/>
        <result property="planId" column="plan_id"/>
        <result property="lessonNum" column="lesson_num"/>
        <result property="lessonBeginTime" column="lesson_begin_time"/>
        <result property="lessonEndTime" column="lesson_end_time"/>
        <result property="frequency" column="frequency"/>
        <result property="status" column="status"/>
        <result property="beginTime" column="begin_time"/>
        <result property="endTime" column="end_time"/>
        <result property="teacher1Id" column="teacher1_id"/>
        <result property="teacher2Id" column="teacher2_id"/>
        <result property="nextLessson" column="next_lessson"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="deleted" column="deleted"/>
        <result property="updater" column="updater"/>
        <result property="creator" column="creator"/>
        <result property="version" column="version"/>
    </resultMap>

    <select id="page" resultType="net.edu.module.vo.TeachClassVO">
        select
        id,
        name,
        description,
        img,plan_id as planId,
        lesson_num as lessonNum,
        lesson_begin_time as lessonBedinTime,
        lesson_end_time as lessonEndTime,
        frequency,
        status,
        begin_time as beginTime,
        end_time as endTime,
        teacher1_id as teacher1Id,
        teacher2_id as teacher2Id
        from teach_class
        where deleted =0
        <if test="query.getName()!=null and query.getName()!=''">
            and  name like concat('%',#{query.name},'%')
        </if>
        order by lesson_num desc,id desc
    </select>
<!--    获取学生在上的所有课程-->
    <select id="getOldClassUser" resultType="net.edu.module.entity.TeachClassEntity">
        select id,name,description,img,plan_id,lesson_num,lesson_begin_time ,lesson_end_time,frequency,status, begin_time,
               end_time,teacher1_id,teacher2_id,next_lessson from teach_class
        where id = (select class_id from teach_class_user where user_id = #{userId})

    </select>
</mapper>
